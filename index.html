<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Message Reminder Book</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        html, body {
            font-family: 'Inter', Arial, sans-serif;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            min-height: 100vh;
            margin: 0;
        }
        .book-wrapper {
            display: flex;
            max-width: 1400px;
            margin: 1.5rem auto;
            background: #ffffff;
            border-radius: 1.5rem;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            min-height: 600px;
            height: calc(100vh - 2rem);
            overflow: auto;
        }
        .sidebar {
            width: 300px;
            background: #f8fafc;
            border-right: 1px solid #e2e8f0;
            padding: 1.5rem;
            overflow-y: auto;
            transition: width 0.3s ease;
        }
        .sidebar-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1.5rem;
        }
        .sidebar h2 {
            font-size: 1.25rem;
            font-weight: 700;
            color: #1e40af;
        }
        .search-container {
            position: relative;
            margin-bottom: 1.5rem;
        }
        .search-input {
            width: 100%;
            padding: 0.5rem 2rem 0.5rem 2.5rem;
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem;
            font-size: 0.9rem;
        }
        .search-icon {
            position: absolute;
            left: 0.75rem;
            top: 50%;
            transform: translateY(-50%);
            color: #64748b;
        }
        .section-title {
            font-size: 0.95rem;
            font-weight: 600;
            color: #047857;
            margin: 1rem 0 0.5rem;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .section-title:hover {
            color: #065f46;
        }
        .msgtype-list {
            list-style: none;
            padding: 0;
            margin: 0;
            max-height: 200px;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: #4f46e5 #e0e7ff;
        }
        .msgtype-list::-webkit-scrollbar {
            width: 8px;
        }
        .msgtype-list::-webkit-scrollbar-thumb {
            background: #4f46e5;
            border-radius: 4px;
        }
        .msgtype-link {
            display: block;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            color: #1f2937;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .msgtype-link:hover, .msgtype-link.active {
            background: #e0e7ff;
            color: #1e40af;
            font-weight: 500;
        }
        .content-area {
            flex: 1;
            padding: 2rem;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: #4f46e5 #e0e7ff;
            min-height: 400px;
        }
        .template-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }
        .template-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #047857;
        }
        .copy-button {
            padding: 0.5rem 1rem;
            background: #4f46e5;
            color: white;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: background 0.2s ease;
        }
        .copy-button:hover {
            background: #4338ca;
        }
        .data-item {
            background: #ecfdf5;
            padding: 1.5rem;
            border-radius: 0.75rem;
            border-left: 6px solid #10b981;
            font-size: 0.95rem;
            line-height: 1.6;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
            margin: 1rem 0;
        }
        th, td {
            padding: 0.75rem;
            border-bottom: 1px solid #e2e8f0;
        }
        th {
            background: #f8fafc;
            font-weight: 600;
            color: #1f2937;
        }
        .collapsible-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }
        .collapsible-content.open {
            max-height: 200px;
        }
        .rotate-180 {
            transform: rotate(180deg);
        }
        @media (max-width: 1024px) {
            .book-wrapper {
                flex-direction: column;
                margin: 0;
                border-radius: 0;
                height: auto;
            }
            .sidebar {
                width: 100%;
                border-right: none;
                border-bottom: 1px solid #e2e8f0;
                max-height: 30vh;
            }
            .content-area {
                padding: 1.5rem;
            }
        }
        @media (max-width: 640px) {
            .template-title {
                font-size: 1.25rem;
            }
            .data-item {
                padding: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="book-wrapper">
        <nav class="sidebar">
            <div class="sidebar-header">
                <h2>Message Reminder Book</h2>
            </div>
            <div class="search-container">
                <svg class="search-icon" width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                </svg>
                <input type="text" id="searchInput" class="search-input" placeholder="Search templates...">
            </div>
            <div id="sidebarContent">
                <div class="section-title" data-section="service-termination" data-collapsed="true">
                    Service Termination
                    <svg class="w-5 h-5 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                    </svg>
                </div>
                <ul class="msgtype-list collapsible-content">
                    <li><a class="msgtype-link" data-section="Service Termination" data-type="EZECOM's Termination">EZECOM's Termination</a></li>
                    <li><a class="msgtype-link" data-section="Service Termination" data-type="Cellcard's Termination">Cellcard's Termination</a></li>
                </ul>
                <div class="section-title" data-section="payment-offset" data-collapsed="true">
                    Payment Offset
                    <svg class="w-5 h-5 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                    </svg>
                </div>
                <ul class="msgtype-list collapsible-content">
                    <li><a class="msgtype-link" data-section="Payment Offset" data-type="Cellcard to EZECOM">Cellcard to EZECOM</a></li>
                    <li><a class="msgtype-link" data-section="Payment Offset" data-type="EZECOM to Cellcard">EZECOM to Cellcard</a></li>
                </ul>
                <div class="section-title" data-section="invoice-follow-up" data-collapsed="true">
                    Invoice Follow Up
                    <svg class="w-5 h-5 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                    </svg>
                </div>
                <ul class="msgtype-list collapsible-content">
                    <li><a class="msgtype-link" data-section="Invoice Follow Up" data-type="1st Follow up">1st Follow up</a></li>
                    <li><a class="msgtype-link" data-section="Invoice Follow Up" data-type="2nd Follow up">2nd Follow up</a></li>
                    <li><a class="msgtype-link" data-section="Invoice Follow Up" data-type="3rd Follow up">3rd Follow up</a></li>
                </ul>
                <div class="section-title" data-section="renewal-reactivation" data-collapsed="true">
                    Renewal/Reactivation Offer
                    <svg class="w-5 h-5 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                    </svg>
                </div>
                <ul class="msgtype-list collapsible-content">
                    <li><a class="msgtype-link" data-section="Renewal/Reactivation Offer" data-type="After Expiry Date Offer">After Expiry Date Offer</a></li>
                    <li><a class="msgtype-link" data-section="Renewal/Reactivation Offer" data-type="Before Expiry Date Offer">Before Expiry Date Offer</a></li>
                </ul>
            </div>
        </nav>
        <main class="content-area">
            <div class="template-header">
                <div id="templateTitle" class="template-title">Select a message type to view the template</div>
                <button id="copyButton" class="copy-button hidden">Copy Template</button>
            </div>
            <div id="templateContent" class="data-item">Please select a message type from the sidebar to view the template.</div>
        </main>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            console.log('DOM fully loaded and script running');

            // Message template functions
            function formatFirstInvoiceFollowUpMessage() {
                return `
                    <strong class="text-lg text-gray-900">Subject: First Reminder - Follow-Up on Pending Invoice Payment</strong><br><br>
                    Dear [Customer's Name],<br><br>
                    I hope this email finds you well.<br><br>
                    We would like to follow up on the outstanding invoice(s) listed below. Kindly arrange payment at your earliest convenience to avoid any service disruption. Please note that terms and conditions apply.<br><br>
                    <strong class="text-gray-800">Invoice Details:</strong><br><br>
                    <table>
                        <thead>
                            <tr>
                                <th>Invoice Number</th>
                                <th>Customer ID</th>
                                <th>Customer Name</th>
                                <th>Amount Pending</th>
                                <th>Invoice Due Date</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>XXXXXXX</td>
                                <td>XXXXXXX</td>
                                <td>####</td>
                                <td>$XXX.XX</td>
                                <td>01-Mar-25</td>
                            </tr>
                        </tbody>
                    </table><br>
                    Should you require any further details or have already processed the payment, please disregard this email and kindly share the payment confirmation with us.<br><br>
                    We appreciate your prompt attention to this matter.<br><br>
                    Best regards,<br>
                    Heng
                `;
            }
            function formatInvoiceFollowUpMessage(subject) {
                return `
                    <strong class="text-lg text-gray-900">Subject: ${subject}</strong><br><br>
                    Dear [Customer's Name],<br><br>
                    We refer to our previous reminder regarding your overdue invoice(s).<br><br>
                    As of today, payment remains outstanding, and immediate action is required to avoid service disconnection or dismantling as per our terms and conditions.<br><br>
                    <table>
                        <thead>
                            <tr>
                                <th>Invoice Number</th>
                                <th>Customer ID</th>
                                <th>Customer Name</th>
                                <th>Amount Pending</th>
                                <th>Invoice Due Date</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>XXXXXXX</td>
                                <td>XXXXXXX</td>
                                <td>####</td>
                                <td>$XXX.XX</td>
                                <td>01-Mar-25</td>
                            </tr>
                        </tbody>
                    </table><br>
                    Please ensure full payment is made by Final Due Date to avoid service disruption. If payment has already been processed, kindly provide the payment confirmation at your earliest convenience.<br><br>
                    Noted: Failure to settle the outstanding balance by the due date will result in immediate action, which may include disconnecting or dismantling of services.<br><br>
                    For any further assistance, feel free to reach out. We appreciate your urgent attention to this matter.<br><br>
                    Best regards,<br>
                    Heng
                `;
            }
            function formatThirdInvoiceFollowUpMessage() {
                return `
                    <strong class="text-lg text-gray-900">Subject: Final Reminder - Immediate Payment Required</strong><br><br>
                    Dear [Customer's Name],<br><br>
                    This is our final reminder regarding your overdue invoice(s). Immediate payment is required to avoid service disconnection or dismantling as per our terms and conditions.<br><br>
                    <strong class="text-gray-800">Invoice Details:</strong><br><br>
                    <table>
                        <thead>
                            <tr>
                                <th>Invoice Number</th>
                                <th>Customer ID</th>
                                <th>Customer Name</th>
                                <th>Amount Pending</th>
                                <th>Invoice Due Date</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>XXXXXXX</td>
                                <td>XXXXXXX</td>
                                <td>####</td>
                                <td>$XXX.XX</td>
                                <td>01-Mar-25</td>
                            </tr>
                        </tbody>
                    </table><br>
                    Please ensure full payment is made immediately to avoid service disruption. If payment has already been processed, kindly provide the payment confirmation at your earliest convenience.<br><br>
                    Noted: Failure to settle the outstanding balance by the due date will result in immediate action, which may include disconnecting or dismantling of services.<br><br>
                    For any further assistance, please reach out. We appreciate your urgent attention to this matter.<br><br>
                    Best regards,<br>
                    Heng
                `;
            }
            function formatReimbursementMessage(fromCompany, toCompany) {
                const subject = fromCompany === "EZECOM" 
                    ? `Request offset from EZECOM ID - ###### to Correct Cellcard ID - ######`
                    : `Request offset from Cellcard ID - ###### to Correct EZECOM ID - ######`;
                const body = fromCompany === "EZECOM" 
                    ? `Dear AR Team,<br><br>
                       We hope this email finds you well.<br><br>
                       A Cellcard's customer mistakenly made a payment to EZECOM. To avoid service disruption, please assist in offsetting and transferring the credit back from EZECOM ID to the correct Cellcard ID account as per the details below:<br><br>`
                    : `Dear AR Team,<br><br>
                       We hope this email finds you well.<br><br>
                       An EZECOM's customer mistakenly made a payment to Cellcard. To avoid service disruption, please assist in offsetting and transferring the credit back from Cellcard ID to the correct EZECOM account as per the details below:<br><br>`;

                return `
                    <strong class="text-lg text-gray-900">Subject: ${subject}</strong><br><br>
                    <strong class="text-gray-800">Send to:</strong> receivable@ezecomcorp.com, huotdara@cellcard.com.kh<br><br>
                    <strong class="text-gray-800">CC:</strong> ychanna@ezecom.com.kh, schanpenhbormey@ezecom.com.kh, customercare@cellcard.com.kh, ARprepaid@cellcard.com.kh, peskadervy@ezecom.com.kh, lheng@ezecom.com.kh<br><br>
                    ${body}
                    <strong class="text-gray-800">Transaction Details:</strong><br><br>
                    <table>
                        <tr>
                            <th>Correct ${toCompany} ID</th>
                            <th>Customer Name</th>
                            <th>Transaction Date</th>
                            <th>Amount Paid</th>
                        </tr>
                        <tr>
                            <td>######</td>
                            <td>######</td>
                            <td>01-Mar-25</td>
                            <td>$108</td>
                        </tr>
                    </table><br>
                    Kindly let us know if any additional information is required. Your prompt assistance would be greatly appreciated.<br><br>
                    Thank you for your cooperation.<br><br>
                    Best regards,
                `;
            }
            function formatTerminationMessage(company, contactNumber) {
                return `
                    <strong class="text-lg text-gray-900">Subject: ${company} - Request Termination form, For Customer CID: 220964, Name: Mr. Namhong Ek</strong><br><br>
                    Dear Valued Customer,<br><br>
                    We regret to inform you that we have received your request to terminate your services with ${company}. We understand that this decision was not made lightly, and we appreciate the time you have spent with us.<br><br>
                    As per our service agreement, a 30-day notice period is required for termination. Your subscription will be terminated following your next billing date.<br><br>
                    To proceed with the termination, please complete the attached termination form, sign and stamp it, and return it to us via email or by visiting the nearest ${company} office.<br><br>
                    Should you reconsider your decision or wish to reactivate your account, please contact our hotline at:<br>
                    <span class="text-blue-600">Contact Number: ${contactNumber}</span><br><br>
                    Thank you for your cooperation and understanding.<br><br>
                    Best regards,<br>
                    ${company}
                `;
            }
            function formatReactivationOfferMessage(company) {
                return `
                    <strong class="text-lg text-gray-900">Subject: Special Offer - Reactivate Your ${company} Internet Service Today!</strong><br><br>
                    Dear [Customer's Name],<br><br>
                    I hope this email finds you well.<br><br>
                    We noticed that your ${company} internet service has expired, and we’d love to welcome you back with a special reactivation offer! Reconnect today and enjoy seamless internet with exclusive benefits tailored just for you.<br><br>
                    <strong class="text-gray-800">Account Details:</strong><br><br>
                    <table>
                        <thead>
                            <tr>
                                <th>Customer ID</th>
                                <th>Customer Name</th>
                                <th>Current Plan</th>
                                <th>Billing Date</th>
                                <th>Renewal Offer</th>
                                <th>Amount</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>XXXXXXX</td>
                                <td>[Customer's Name]</td>
                                <td>10 Mbps Plan</td>
                                <td>01-Apr-25</td>
                                <td>50% Off First Month</td>
                                <td>$XX.XX</td>
                            </tr>
                        </tbody>
                    </table><br>
                    To reactivate your service, simply reply to this email or contact our support team at <span class="text-blue-600">${company === 'EZECOM' ? '085 888 181' : '012 812 812'}</span>. Don’t miss out—this offer is valid for a limited time only!<br><br>
                    We look forward to serving you again.<br><br>
                    Best regards,<br>
                    Heng<br>
                    ${company} Team
                `;
            }
            function formatRenewalOfferMessage(company) {
                return `
                    <strong class="text-lg text-gray-900">Subject: Special Offer - Renew Your ${company} Internet Service Before It Expires!</strong><br><br>
                    Dear [Customer's Name],<br><br>
                    I hope this email finds you well.<br><br>
                    We noticed that your ${company} internet service is nearing its expiry date. To ensure uninterrupted access to your reliable internet connection, we’re offering you a special renewal deal! Renew before your service expires and enjoy continued seamless connectivity with added benefits.<br><br>
                    <strong class="text-gray-800">Account Details:</strong><br><br>
                    <table>
                        <thead>
                            <tr>
                                <th>Customer ID</th>
                                <th>Customer Name</th>
                                <th>Current Plan</th>
                                <th>Billing Date</th>
                                <th>Renewal Offer</th>
                                <th>Amount</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>XXXXXXX</td>
                                <td>[Customer's Name]</td>
                                <td>10 Mbps Plan</td>
                                <td>01-Apr-25</td>
                                <td>10% Off Next Month</td>
                                <td>$XX.XX</td>
                            </tr>
                        </tbody>
                    </table><br>
                    To renew your service and avoid any disruption, please reply to this email or contact our support team at <span class="text-blue-600">${company === 'EZECOM' ? '085 888 181' : '012 812 812'}</span> before your expiry date. Act now to take advantage of this limited-time offer!<br><br>
                    We value your continued trust in ${company} and look forward to keeping you connected.<br><br>
                    Best regards,<br>
                    Heng<br>
                    ${company} Team
                `;
            }

            // Message type mapping
            const templateMap = {
                "EZECOM's Termination": () => formatTerminationMessage("EZECOM", "085 888 181"),
                "Cellcard's Termination": () => formatTerminationMessage("Cellcard", "012 812 812"),
                "Cellcard to EZECOM": () => formatReimbursementMessage("Cellcard", "EZECOM"),
                "EZECOM to Cellcard": () => formatReimbursementMessage("EZECOM", "Cellcard"),
                "1st Follow up": () => formatFirstInvoiceFollowUpMessage(),
                "2nd Follow up": () => formatInvoiceFollowUpMessage("Second Reminder - Urgent Payment Required"),
                "3rd Follow up": () => formatThirdInvoiceFollowUpMessage(),
                "After Expiry Date Offer": () => formatReactivationOfferMessage("EZECOM"),
                "Before Expiry Date Offer": () => formatRenewalOfferMessage("EZECOM"),
            };

            // UI logic
            const state = {
                activeLink: null,
                searchQuery: '',
            };

            function updateUI() {
                try {
                    const links = document.querySelectorAll('.msgtype-link');
                    links.forEach(link => {
                        const type = link.getAttribute('data-type')?.toLowerCase() || '';
                        const section = link.getAttribute('data-section')?.toLowerCase() || '';
                        const matchesSearch = state.searchQuery === '' || 
                            type.includes(state.searchQuery.toLowerCase()) || 
                            section.includes(state.searchQuery.toLowerCase());
                        const parentLi = link.parentElement;
                        if (parentLi) {
                            parentLi.style.display = matchesSearch ? 'block' : 'none';
                        }
                    });

                    document.querySelectorAll('.section-title').forEach(title => {
                        const content = title.nextElementSibling;
                        if (!content) return;
                        content.style.display = 'block'; // Ensure sections are visible by default
                    });
                } catch (error) {
                    console.error('Error in updateUI:', error);
                }
            }

            // Initialize collapsible sections
            try {
                const sectionTitles = document.querySelectorAll('.section-title');
                sectionTitles.forEach(title => {
                    const content = title.nextElementSibling;
                    if (!content) {
                        console.warn('No content found for section title:', title);
                        return;
                    }
                    if (title.getAttribute('data-collapsed') === 'true') {
                        content.classList.remove('open');
                        content.style.maxHeight = '0';
                    } else {
                        content.classList.add('open');
                        content.style.maxHeight = `${content.scrollHeight}px`;
                    }

                    title.addEventListener('click', () => {
                        try {
                            const isCollapsed = title.getAttribute('data-collapsed') === 'true';
                            title.setAttribute('data-collapsed', !isCollapsed);
                            content.classList.toggle('open');
                            content.style.maxHeight = isCollapsed ? `${content.scrollHeight}px` : '0';
                            const svg = title.querySelector('svg');
                            if (svg) {
                                svg.classList.toggle('rotate-180');
                            }
                        } catch (error) {
                            console.error('Error in section title click:', error);
                        }
                    });
                });
            } catch (error) {
                console.error('Error initializing collapsible sections:', error);
            }

            // Handle template selection
            try {
                const msgTypeLinks = document.querySelectorAll('.msgtype-link');
                msgTypeLinks.forEach(link => {
                    link.addEventListener('click', function(e) {
                        try {
                            e.preventDefault();
                            if (state.activeLink) {
                                state.activeLink.classList.remove('active');
                            }
                            this.classList.add('active');
                            state.activeLink = this;

                            const type = this.getAttribute('data-type');
                            console.log('Selected template:', type);
                            const templateTitle = document.getElementById('templateTitle');
                            const templateContent = document.getElementById('templateContent');
                            const copyButton = document.getElementById('copyButton');

                            if (templateTitle && templateContent && copyButton) {
                                templateTitle.textContent = type || 'Unknown Template';
                                const templateFn = templateMap[type];
                                templateContent.innerHTML = templateFn ? templateFn() : '<em>No template found.</em>';
                                copyButton.classList.remove('hidden');
                            } else {
                                console.warn('Template elements not found:', { templateTitle, templateContent, copyButton });
                            }
                        } catch (error) {
                            console.error('Error in template selection:', error);
                        }
                    });
                });
            } catch (error) {
                console.error('Error setting up template links:', error);
            }

            // Search functionality
            try {
                const searchInput = document.getElementById('searchInput');
                if (searchInput) {
                    searchInput.addEventListener('input', (e) => {
                        try {
                            state.searchQuery = e.target.value || '';
                            updateUI();
                        } catch (error) {
                            console.error('Error in search input:', error);
                        }
                    });
                } else {
                    console.warn('Search input not found');
                }
            } catch (error) {
                console.error('Error setting up search:', error);
            }

            // Copy to clipboard
            try {
                const copyButton = document.getElementById('copyButton');
                if (copyButton) {
                    copyButton.addEventListener('click', () => {
                        try {
                            const templateContent = document.getElementById('templateContent');
                            if (!templateContent) {
                                console.warn('Template content not found');
                                return;
                            }
                            const content = templateContent.innerText;
                            if (content) {
                                navigator.clipboard.writeText(content).then(() => {
                                    copyButton.textContent = 'Copied!';
                                    setTimeout(() => {
                                        copyButton.textContent = 'Copy Template';
                                    }, 2000);
                                }).catch(err => {
                                    console.error('Failed to copy text:', err);
                                    copyButton.textContent = 'Copy Failed';
                                    setTimeout(() => {
                                        copyButton.textContent = 'Copy Template';
                                    }, 2000);
                                });
                            }
                        } catch (error) {
                            console.error('Error in copy to clipboard:', error);
                        }
                    });
                } else {
                    console.warn('Copy button not found');
                }
            } catch (error) {
                console.error('Error setting up copy button:', error);
            }

            // Initial UI update
            try {
                updateUI();
            } catch (error) {
                console.error('Error in initial UI update:', error);
            }
        });
    </script>
</body>
</html>
