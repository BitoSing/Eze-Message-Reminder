<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Message Templates</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        html, body {
            font-family: 'Inter', Arial, sans-serif;
            background: linear-gradient(135deg, #ffffff 0%, #e6f0fa 100%); /* White to light blue gradient */
            min-height: 100vh;
            margin: 0;
            height: auto;
            overflow: auto; /* Allow scrolling for the entire page */
        }
        .book-wrapper {
            display: flex;
            max-width: 1400px;
            margin: 1.5rem auto;
            background: #ffffff; /* White background */
            border-radius: 1.5rem;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            height: 100%; /* Allow the wrapper to expand naturally */
            overflow: hidden;
        }
        .sidebar {
            width: 300px;
            background: #f6faff; /* Very light blue */
            border-right: 1px solid #d1e0ff; /* Light blue border */
            padding: 1.5rem;
            overflow-y: auto;
            transition: width 0.3s ease;
        }
        .sidebar-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1.5rem;
        }
        .sidebar h2 {
            font-size: 1.25rem;
            font-weight: 700;
            color: #1e3a8a; /* Dark blue */
        }
        .search-container {
            position: relative;
            margin-bottom: 1.5rem;
        }
        .search-input {
            width: 100%;
            padding: 0.5rem 2rem 0.5rem 2.5rem;
            border: 1px solid #d1e0ff; /* Light blue border */
            border-radius: 0.5rem;
            font-size: 0.9rem;
        }
        .search-icon {
            position: absolute;
            left: 0.75rem;
            top: 50%;
            transform: translateY(-50%);
            color: #64748b;
        }
        .section-title {
            font-size: 0.95rem;
            font-weight: 600;
            color: #1e3a8a; /* Dark blue */
            margin: 1rem 0 0.5rem;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .section-title:hover {
            color: #3b82f6; /* Lighter blue on hover */
        }
        .msgtype-list {
            list-style: none;
            padding: 0;
            margin: 0;
            max-height: 200px;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: #3b82f6 #e6f0fa; /* Blue scrollbar */
        }
        .msgtype-list::-webkit-scrollbar {
            width: 8px;
        }
        .msgtype-list::-webkit-scrollbar-thumb {
            background: #3b82f6; /* Blue scrollbar thumb */
            border-radius: 4px;
        }
        .msgtype-link {
            display: block;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            color: #1f2937;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .msgtype-link:hover, .msgtype-link.active {
            background: #dbeafe; /* Light blue background */
            color: #1e3a8a; /* Dark blue text */
            font-weight: 500;
        }
        .content-area {
            flex: 1;
            padding: 2rem;
            overflow-y: auto; /* Enable vertical scrolling */
            scrollbar-width: thin;
            scrollbar-color: #3b82f6 #e6f0fa; /* Blue scrollbar */
            max-height: 100%; /* Ensure it doesn't exceed the viewport height */
            background: #ffffff; /* White background */
        }
        .template-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }
        .template-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1e3a8a; /* Dark blue */
        }
        .copy-button {
            padding: 0.5rem 1rem;
            background: #1e3a8a; /* Blue button */
            color: white;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: background 0.2s ease;
        }
        .copy-button:hover {
            background: #1e3a8a; /* Darker blue on hover */
        }
        .data-item {
            background: #f6faff; /* Very light blue background */
            padding: 1.5rem;
            border-radius: 0.75rem;
            border-left: 6px solid #1e3a8a; /* Blue border */
            font-size: 0.95rem;
            line-height: 1.5;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
            margin: 1rem 0;
        }
        th, td {
            padding: 0.75rem;
            border-bottom: 1px solid #d1e0ff; /* Light blue border */
        }
        th {
            background: #f6faff; /* Very light blue */
            font-weight: 600;
            color: #1f2937;
        }
        .collapsible-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }
        .collapsible-content.open {
            max-height: 200px;
        }
        .rotate-180 {
            transform: rotate(180deg);
        }
        @media (max-width: 1024px) {
            .book-wrapper {
                flex-direction: column;
                margin: 0;
                border-radius: 0;
                height: auto; /* Allow content to expand naturally */
            }
            .sidebar {
                width: 100%;
                border-right: none;
                border-bottom: 1px solid #d1e0ff; /* Light blue border */
                max-height: 30vh;
                overflow-y: auto; /* Ensure scrolling for long content */
            }
            .content-area {
                padding: 1.5rem;
                height: auto; /* Allow content to expand naturally */
                overflow-y: auto; /* Enable scrolling for content area */
            }
        }
        @media (max-width: 640px) {
            .template-title {
                font-size: 1.25rem;
            }
            .data-item {
                padding: 1rem;
            }
            .sidebar {
                max-height: 40vh; /* Increase height for better usability */
            }
            .search-input {
                font-size: 0.8rem; /* Adjust font size for smaller screens */
            }
            .msgtype-link {
                font-size: 0.8rem; /* Adjust font size for smaller screens */
            }
            .content-area {
                overflow-y: auto; /* Ensure scrolling for smaller screens */
            }
        }
    </style>
</head>
<body>
    <div class="book-wrapper">
        <nav class="sidebar">
            <div class="sidebar-header">
                <h2>Message Templates</h2>
            </div>
            <div class="search-container">
                <svg class="search-icon" width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                </svg>
                <input type="text" id="searchInput" class="search-input" placeholder="Search templates...">
            </div>
            <div id="sidebarContent">
                <div class="section-title" data-section="incident-report" data-collapsed="true">
                    Incident Report
                    <svg class="w-5 h-5 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                    </svg>
                </div>
                <ul class="msgtype-list collapsible-content">
                    <li><a class="msgtype-link" data-section="Incident Report" data-type="Request Incident Report">Request Incident Report</a></li>
                </ul>
                <div class="section-title" data-section="service-termination" data-collapsed="true">
                    Service Termination
                    <svg class="w-5 h-5 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                    </svg>
                </div>
                <ul class="msgtype-list collapsible-content">
                    <li><a class="msgtype-link" data-section="Service Termination" data-type="EZECOM's Termination">EZECOM's Termination</a></li>
                    <li><a class="msgtype-link" data-section="Service Termination" data-type="Cellcard's Termination">Cellcard's Termination</a></li>
                </ul>
                <div class="section-title" data-section="payment-offset" data-collapsed="true">
                    Payment Offset
                    <svg class="w-5 h-5 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                    </svg>
                </div>
                <ul class="msgtype-list collapsible-content">
                    <li><a class="msgtype-link" data-section="Payment Offset" data-type="Cellcard to EZECOM">Cellcard to EZECOM</a></li>
                    <li><a class="msgtype-link" data-section="Payment Offset" data-type="EZECOM to Cellcard">EZECOM to Cellcard</a></li>
                </ul>
                <div class="section-title" data-section="invoice-follow-up" data-collapsed="true">
                    Invoice Follow Up
                    <svg class="w-5 h-5 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                    </svg>
                </div>
                <ul class="msgtype-list collapsible-content">
                    <li><a class="msgtype-link" data-section="Invoice Follow Up" data-type="1st Follow up">1st Follow up</a></li>
                    <li><a class="msgtype-link" data-section="Invoice Follow Up" data-type="2nd Follow up">2nd Follow up</a></li>
                    <li><a class="msgtype-link" data-section="Invoice Follow Up" data-type="3rd Follow up">3rd Follow up</a></li>
                </ul>
                <div class="section-title" data-section="renewal-reactivation" data-collapsed="true">
                    Renewal/Reactivation Offer
                    <svg class="w-5 h-5 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                    </svg>
                </div>
                <ul class="msgtype-list collapsible-content">
                    <li><a class="msgtype-link" data-section="Renewal/Reactivation Offer" data-type="After Expiry Date Offer">After Expiry Date Offer</a></li>
                    <li><a class="msgtype-link" data-section="Renewal/Reactivation Offer" data-type="Before Expiry Date Offer">Before Expiry Date Offer</a></li>
                </ul>
                <div class="section-title" data-section="telegram-message" data-collapsed="true">
                    Telegram Message
                    <svg class="w-5 h-5 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                    </svg>
                </div>
                <ul class="msgtype-list collapsible-content">
                    <li><a class="msgtype-link" data-section="Telegram Message" data-type="Renewal Offer">Renewal Offer</a></li>
                    <li><a class="msgtype-link" data-section="Telegram Message" data-type="After Expired Offer">After Expired Offer</a></li>
                    <li><a class="msgtype-link" data-section="Telegram Message" data-type="Alert for Technical Issue">Alert for Technical Issue</a></li>
                    <li><a class="msgtype-link" data-section="Telegram Message" data-type="Change Plan Confirmation">Change Plan Confirmation</a></li>
                    <li><a class="msgtype-link" data-section="Telegram Message" data-type="Termination Confirmation">Termination Confirmation</a></li>
                </ul>
            </div>
        </nav>
        <main class="content-area">
            <div class="template-header">
                <div id="templateTitle" class="template-title">Select a message type to view the template</div>
                <button id="copyButton" class="copy-button hidden">Copy Template</button>
            </div>
            <div id="templateContent" class="data-item">Please select a message type from the sidebar to view the template.</div>
        </main>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            console.log('DOM fully loaded and script running');

            // Message template functions
            function formatIncidentReportMessage() {
                return `
                    <strong class="text-lg text-gray-900">Subject: Request Incident Report of CID: ####, SID: ####, Name: ####</strong><br><br>
                    Dear Bong,<br><br>
                    I hope this email finds you well.<br><br>
                    We would like to seek for your support to provide us the incident report from [DD/MM/YYYY] to [DD/MM/YYYY], though the customer encountered internet service’s cut off and demands to compensate the non-usage period back.<br><br>
                    Your prompt response would be greatly appreciated. Let me know if you require any additional information.<br><br>
                    Thank you for your cooperation.<br><br>
                    Best regards,<br>
                    LY HENG
                `;
            }
            function formatFirstInvoiceFollowUpMessage() {
                return `
                    <strong class="text-lg text-gray-900">Subject: First Reminder - Follow-Up on Pending Invoice Payment</strong><br><br>
                    Dear [Customer's Name],<br><br>
                    I hope this email finds you well.<br><br>
                    We would like to follow up on the outstanding invoice(s) listed below. Kindly arrange payment at your earliest convenience to avoid any service disruption. Please note that terms and conditions apply.<br><br>
                    <strong class="text-gray-800">Invoice Details:</strong><br><br>
                    - Invoice Number    : #####,<br>
                    - Customer ID       : #####,<br>
                    - Customer Name     : #####,<br>
                    - Amount Pending    : #####,<br>
                    - Invoice Due Date  : #####,<br><br>
                    Should you require any further details or have already processed the payment, please disregard this email and kindly share the payment confirmation with us.<br><br>
                    We appreciate your prompt attention to this matter.<br><br>
                    Best regards,<br>
                    Heng
                `;
            }
            function formatInvoiceFollowUpMessage(subject) {
                return `
                    <strong class="text-lg text-gray-900">Subject: ${subject}</strong><br><br>
                    Dear [Customer's Name],<br><br>
                    We refer to our previous reminder regarding your overdue invoice(s).<br><br>
                    As of today, payment remains outstanding, and immediate action is required to avoid service disconnection or dismantling as per our terms and conditions.<br><br>
                    - Invoice Number    : #####,<br>
                    - Customer ID       : #####,<br>
                    - Customer Name     : #####,<br>
                    - Amount Pending    : #####,<br>
                    - Invoice Due Date  : #####,<br><br>
                    Please ensure full payment is made by Final Due Date to avoid service disruption. If payment has already been processed, kindly provide the payment confirmation at your earliest convenience.<br><br>
                    Noted: Failure to settle the outstanding balance by the due date will result in immediate action, which may include disconnecting or dismantling of services.<br><br>
                    For any further assistance, feel free to reach out. We appreciate your urgent attention to this matter.<br><br>
                    Best regards,<br>
                    Heng
                `;
            }
            function formatThirdInvoiceFollowUpMessage() {
                return `
                    <strong class="text-lg text-gray-900">Subject: Final Reminder - Immediate Payment Required</strong><br><br>
                    Dear [Customer's Name],<br><br>
                    This is our final reminder regarding your overdue invoice(s). Immediate payment is required to avoid service disconnection or dismantling as per our terms and conditions.<br><br>
                    <strong class="text-gray-800">Invoice Details:</strong><br><br>
                    - Invoice Number    : #####,<br>
                    - Customer ID       : #####,<br>
                    - Customer Name     : #####,<br>
                    - Amount Pending    : #####,<br>
                    - Invoice Due Date  : #####,<br><br>
                    Please ensure full payment is made immediately to avoid service disruption. If payment has already been processed, kindly provide the payment confirmation at your earliest convenience.<br><br>
                    Noted: Failure to settle the outstanding balance by the due date will result in immediate action, which may include disconnecting or dismantling of services.<br><br>
                    For any further assistance, please reach out. We appreciate your urgent attention to this matter.<br><br>
                    Best regards,<br>
                    Heng
                `;
            }
            function formatReimbursementMessage(fromCompany, toCompany) {
                const subject = fromCompany === "EZECOM" 
                    ? `Request offset from EZECOM ID - ###### to Correct Cellcard ID - ######`
                    : `Request offset from Cellcard ID - ###### to Correct EZECOM ID - ######`;
                const body = fromCompany === "EZECOM" 
                    ? `Dear AR Team,<br><br>
                       We hope this email finds you well.<br><br>
                       A Cellcard's customer mistakenly made a payment to EZECOM. To avoid service disruption, please assist in offsetting and transferring the credit back from EZECOM ID to the correct Cellcard ID account as per the details below:<br><br>`
                    : `Dear AR Team,<br><br>
                       We hope this email finds you well.<br><br>
                       An EZECOM's customer mistakenly made a payment to Cellcard. To avoid service disruption, please assist in offsetting and transferring the credit back from Cellcard ID to the correct EZECOM account as per the details below:<br><br>`;

                return `
                    <strong class="text-lg text-gray-900">Subject: ${subject}</strong><br><br>
                    <strong class="text-gray-800">Send to:</strong> receivable@ezecomcorp.com, huotdara@cellcard.com.kh<br><br>
                    <strong class="text-gray-800">CC:</strong> ychanna@ezecom.com.kh, schanpenhbormey@ezecom.com.kh, customercare@cellcard.com.kh, ARprepaid@cellcard.com.kh, peskadervy@ezecom.com.kh, lheng@ezecom.com.kh<br><br>
                    ${body}
                    <strong class="text-gray-800">Transaction Details:</strong><br><br>
                    - Correct ${toCompany} ID : #####,<br>
                    - Customer Name          : #####,<br>
                    - Transaction Date       : #####,<br>
                    - Amount Paid            : #####,<br><br>
                    Kindly let us know if any additional information is required. Your prompt assistance would be greatly appreciated.<br><br>
                    Thank you for your cooperation.<br><br>
                    Best regards,
                `;
            }
            function formatTerminationMessage(company, contactNumber) {
                return `
                    <strong class="text-lg text-gray-900">Subject: ${company} - Termination Request for CID: 220964, Mr. Namhong Ek</strong><br><br>
                    Dear Mr. Namhong Ek,<br><br>
                    We are deeply saddened to receive your request to terminate your ${company} services. Your time with us has been greatly valued, and we sincerely regret seeing you go.<br><br>
                    As per our service agreement, a 30-day notice period applies, and your subscription will conclude after your next billing cycle. To proceed, please complete, sign, and stamp the attached termination form and return it via email or at a ${company} office.<br><br>
                    We truly hope you might reconsider this decision. Should you wish to discuss your options or reactivate your account, please contact our dedicated team at <span class="text-blue-600">${contactNumber}</span>. We would be honored to continue serving you.<br><br>
                    Thank you for your understanding and past support.<br><br>
                    Warm regards,<br>
                    ${company} Customer Service
                `;
            }
            function formatReactivationOfferMessage(company) {
                return `
                    <strong class="text-lg text-gray-900">Subject: Special Offer - Reactivate Your ${company} Internet Service Today!</strong><br><br>
                    Dear [Customer's Name],<br><br>
                    I hope this email finds you well.<br><br>
                    We noticed that your ${company} internet service has expired, and we’d love to welcome you back with a special reactivation offer! Reconnect today and enjoy seamless internet with exclusive benefits tailored just for you.<br><br>
                    <strong class="text-gray-800">Account Details:</strong><br><br>
                    - Customer ID        : #####,<br>
                    - Customer Name      : #####,<br>
                    - Current Plan       : #####,<br>
                    - Billing Date       : #####,<br>
                    - Renewal Offer      : #####,<br>
                    - Amount             : #####,<br><br>
                    To reactivate your service, simply reply to this email or contact our support team at <span class="text-blue-600">${company === 'EZECOM' ? '085 888 181' : '012 812 812'}</span>. Don’t miss out—this offer is valid for a limited time only!<br><br>
                    We look forward to serving you again.<br><br>
                    Best regards,<br>
                    Heng<br>
                    ${company} Team
                `;
            }
            function formatRenewalOfferMessage(company) {
                return `
                    <strong class="text-lg text-gray-900">Subject: Special Offer - Renew Your ${company} Internet Service Before It Expires!</strong><br><br>
                    Dear [Customer's Name],<br><br>
                    I hope this email finds you well.<br><br>
                    We noticed that your ${company} internet service is nearing its expiry date. To ensure uninterrupted access to your reliable internet connection, we’re offering you a special renewal deal! Renew before your service expires and enjoy continued seamless connectivity with added benefits.<br><br>
                    <strong class="text-gray-800">Account Details:</strong><br><br>
                    - Customer ID        : #####,<br>
                    - Customer Name      : #####,<br>
                    - Current Plan       : #####,<br>
                    - Billing Date       : #####,<br>
                    - Renewal Offer      : #####,<br>
                    - Amount             : #####,<br><br>
                    To renew your service and avoid any disruption, please reply to this email or contact our support team at <span class="text-blue-600">${company === 'EZECOM' ? '085 888 181' : '012 812 812'}</span> before your expiry date. Act now to take advantage of this limited-time offer!<br><br>
                    We value your continued trust in ${company} and look forward to keeping you connected.<br><br>
                    Best regards,<br>
                    Heng<br>
                    ${company} Team
                `;
            }
            function formatTelegramRenewalOfferMessage() {
                return `
                    Renew Your Plan & Save! 🌟<br><br>
                    Dear [Customer's Name], your service plan is about to expire. Grab this exclusive offer to keep your services running! 🚀<br><br>
                    <strong>Your Details:</strong><br>
                    * <strong>CID:</strong> [Customer ID]<br>
                    * <strong>SID:</strong> [Subscription ID]<br>
                    * <strong>Name:</strong> [Customer Name]<br>
                    * <strong>Billing:</strong> [Billing Date]<br>
                    * <strong>Location:</strong> [Customer Location]<br><br>
                    Offer: [12 Months Free 3 Months] 🎉<br>
                    <strong>Price: [#####]</strong><br><br>
                    Respond or reach out to us for further details! 💬<br><br>
                    Good Luck,
                `;
            }
            function formatTelegramAfterExpiredOfferMessage() {
                return `
                    Come Back with a Great Deal! 🎁<br><br>
                    Dear [Customer's Name], your service plan has been expired. Grab this exclusive offer to keep your services running! 🚀<br><br>
                    <strong>Your Details:</strong><br>
                    * <strong>CID:</strong> [Customer ID]<br>
                    * <strong>SID:</strong> [Subscription ID]<br>
                    * <strong>Name:</strong> [Customer Name]<br>
                    * <strong>Billing:</strong> [Billing Date]<br>
                    * <strong>Location:</strong> [Customer Location]<br><br>
                    Reactivate Offer: [12 Months Free 3 Months] 🎉<br>
                    <strong>Price: [#####]</strong><br><br>
                    Respond or reach out to us for further details! 💬<br><br>
                    Good Luck,
                `;
            }
            function formatTelegramChangePlanConfirmationMessage() {
                return `
                    Confirm Your New Plan! 🌟<br><br>
                    Dear Valuable Customer,<br><br>
                    We’re excited to offer you an upgraded plan! Please confirm to switch to the new plan below: 🚀<br><br>
                    <strong>Your Details:</strong><br>
                    * <strong>CID:</strong> #####<br>
                    * <strong>SID:</strong> #####<br>
                    * <strong>Name:</strong> #####<br>
                    * <strong>Location:</strong> #####<br>
                    * <strong>Billing:</strong> #####<br><br>
                    Proposed New Plan: ##### 🎉<br>
                    <strong>Price: #####</strong><br><br>
                    To confirm, reply “YES” or contact us back. Deadline Confirmation DD/MMM/YYYY. 💬<br><br>
                    Thank you for choosing as your partner service internet provider!<br><br>
                    EZECOM & CELLCARD
                `;
            }
            function formatTelegramAlertForTechnicalIssueMessage() {
                return `
                    Dear [Customer Name],<br><br>
                    We deeply regret the inconvenience caused by your internet service issue. A support ticket has been created, and our technical team is prioritizing a swift resolution. You will be contacted soon.<br><br>
                    For further assistance, please reach out via:<br><br>
                    📞 Hotline: 085 888 181<br>
                    💬 EZECOM Telegram: @EZECOM_Agent_bot<br>
                    💬 CELLCARD Telegram: @Cellcard_Bot<br><br>
                    Thank you for your patience and trust in [EZECOM/CELLCARD]. 🌟<br><br>
                    Sincerely,<br>
                    EZECOM/CELLCARD
                `;
            }
            function formatTelegramTerminationConfirmationMessage() {
                return `
                    Dear Mr. Namhong Ek,<br><br>
                    We are deeply saddened to receive your request to terminate your EZECOM services 😔. Your valued patronage has been greatly appreciated.<br><br>
                    As per our agreement, a 30-day notice period applies, and your subscription will end after your next billing cycle. Kindly complete, sign, and stamp the attached form 📝 and return it via email or at an EZECOM office.<br><br>
                    We sincerely hope you might reconsider. Please contact us at 085 888 181 to discuss your options or reactivate your account 📞.<br><br>
                    Thank you for your cooperation and past support.<br><br>
                    Sincerely,<br>
                    EZECOM
                `;
            }

            // Message type mapping
            const templateMap = {
                "Request Incident Report": () => formatIncidentReportMessage(),
                "EZECOM's Termination": () => formatTerminationMessage("EZECOM", "085 888 181"),
                "Cellcard's Termination": () => formatTerminationMessage("Cellcard", "012 812 812"),
                "Cellcard to EZECOM": () => formatReimbursementMessage("Cellcard", "EZECOM"),
                "EZECOM to Cellcard": () => formatReimbursementMessage("EZECOM", "Cellcard"),
                "1st Follow up": () => formatFirstInvoiceFollowUpMessage(),
                "2nd Follow up": () => formatInvoiceFollowUpMessage("Second Reminder - Urgent Payment Required"),
                "3rd Follow up": () => formatThirdInvoiceFollowUpMessage(),
                "After Expiry Date Offer": () => formatReactivationOfferMessage("EZECOM"),
                "Before Expiry Date Offer": () => formatRenewalOfferMessage("EZECOM"),
                "Renewal Offer": () => formatTelegramRenewalOfferMessage(),
                "After Expired Offer": () => formatTelegramAfterExpiredOfferMessage(),
                "Alert for Technical Issue": () => formatTelegramAlertForTechnicalIssueMessage(),
                "Change Plan Confirmation": () => formatTelegramChangePlanConfirmationMessage(),
                "Termination Confirmation": () => formatTelegramTerminationConfirmationMessage(),
            };

            // UI logic
            const state = {
                activeLink: null,
                searchQuery: '',
            };

            function updateUI() {
                try {
                    const searchQuery = state.searchQuery.toLowerCase();
                    let anySectionVisible = false;

                    document.querySelectorAll('.section-title').forEach(title => {
                        const sectionName = title.getAttribute('data-section')?.toLowerCase() || '';
                        const content = title.nextElementSibling;
                        if (!content) return;

                        // Filter links within this section
                        const links = content.querySelectorAll('.msgtype-link');
                        let hasVisibleLinks = false;

                        links.forEach(link => {
                            const type = link.getAttribute('data-type')?.toLowerCase() || '';
                            const matchesSearch = searchQuery === '' || 
                                type.includes(searchQuery) || 
                                sectionName.includes(searchQuery);
                            
                            link.parentElement.style.display = matchesSearch ? 'block' : 'none';
                            if (matchesSearch) hasVisibleLinks = true;
                        });

                        // Show/hide section based on visible links or section name match
                        const sectionMatches = searchQuery === '' || sectionName.includes(searchQuery);
                        const shouldShowSection = sectionMatches || hasVisibleLinks;

                        title.style.display = shouldShowSection ? 'flex' : 'none';
                        content.style.display = shouldShowSection ? 'block' : 'none';

                        // Update collapsible state if section is visible
                        if (shouldShowSection) {
                            const isCollapsed = title.getAttribute('data-collapsed') === 'true';
                            content.classList.toggle('open', !isCollapsed && hasVisibleLinks);
                            content.style.maxHeight = (!isCollapsed && hasVisibleLinks) ? `${content.scrollHeight}px` : '0';
                            const svg = title.querySelector('svg');
                            if (svg) {
                                svg.classList.toggle('rotate-180', !isCollapsed);
                            }
                        }

                        if (shouldShowSection) anySectionVisible = true;
                    });

                    // If no sections are visible, show a message or handle empty state
                    const sidebarContent = document.getElementById('sidebarContent');
                    if (!anySectionVisible && searchQuery !== '') {
                        sidebarContent.innerHTML += '<p class="text-gray-500 text-sm p-2">No matching templates found.</p>';
                    } else {
                        // Remove no-results message if it exists
                        const noResults = sidebarContent.querySelector('.text-gray-500');
                        if (noResults) noResults.remove();
                    }
                } catch (error) {
                    console.error('Error in updateUI:', error);
                }
            }

            // Initialize collapsible sections
            try {
                const sectionTitles = document.querySelectorAll('.section-title');
                sectionTitles.forEach(title => {
                    const content = title.nextElementSibling;
                    if (!content) {
                        console.warn('No content found for section title:', title);
                        return;
                    }
                    if (title.getAttribute('data-collapsed') === 'true') {
                        content.classList.remove('open');
                        content.style.maxHeight = '0';
                    } else {
                        content.classList.add('open');
                        content.style.maxHeight = `${content.scrollHeight}px`;
                    }

                    title.addEventListener('click', () => {
                        try {
                            const isCollapsed = title.getAttribute('data-collapsed') === 'true';
                            title.setAttribute('data-collapsed', !isCollapsed);
                            content.classList.toggle('open');
                            content.style.maxHeight = isCollapsed ? `${content.scrollHeight}px` : '0';
                            const svg = title.querySelector('svg');
                            if (svg) {
                                svg.classList.toggle('rotate-180');
                            }
                        } catch (error) {
                            console.error('Error in section title click:', error);
                        }
                    });
                });
            } catch (error) {
                console.error('Error initializing collapsible sections:', error);
            }

            // Handle template selection
            try {
                const msgTypeLinks = document.querySelectorAll('.msgtype-link');
                msgTypeLinks.forEach(link => {
                    link.addEventListener('click', function(e) {
                        try {
                            e.preventDefault();
                            if (state.activeLink) {
                                state.activeLink.classList.remove('active');
                            }
                            this.classList.add('active');
                            state.activeLink = this;

                            const type = this.getAttribute('data-type');
                            console.log('Selected template:', type);
                            const templateTitle = document.getElementById('templateTitle');
                            const templateContent = document.getElementById('templateContent');
                            const copyButton = document.getElementById('copyButton');

                            if (templateTitle && templateContent && copyButton) {
                                templateTitle.textContent = type || 'Unknown Template';
                                const templateFn = templateMap[type];
                                templateContent.innerHTML = templateFn ? templateFn() : '<em>No template found.</em>';
                                copyButton.classList.remove('hidden');
                            } else {
                                console.warn('Template elements not found:', { templateTitle, templateContent, copyButton });
                            }
                        } catch (error) {
                            console.error('Error in template selection:', error);
                        }
                    });
                });
            } catch (error) {
                console.error('Error setting up template links:', error);
            }

            // Search functionality
            try {
                const searchInput = document.getElementById('searchInput');
                if (searchInput) {
                    searchInput.addEventListener('input', (e) => {
                        try {
                            state.searchQuery = e.target.value || '';
                            updateUI();
                        } catch (error) {
                            console.error('Error in search input:', error);
                        }
                    });
                } else {
                    console.warn('Search input not found');
                }
            } catch (error) {
                console.error('Error setting up search:', error);
            }

            // Copy to clipboard
            try {
                const copyButton = document.getElementById('copyButton');
                if (copyButton) {
                    copyButton.addEventListener('click', () => {
                        try {
                            const templateContent = document.getElementById('templateContent');
                            if (!templateContent) {
                                console.warn('Template content not found');
                                return;
                            }
                            const content = templateContent.innerText;
                            if (content) {
                                navigator.clipboard.writeText(content).then(() => {
                                    copyButton.textContent = 'Copied!';
                                    setTimeout(() => {
                                        copyButton.textContent = 'Copy Template';
                                    }, 2000);
                                }).catch(err => {
                                    console.error('Failed to copy text:', err);
                                    copyButton.textContent = 'Copy Failed';
                                    setTimeout(() => {
                                        copyButton.textContent = 'Copy Template';
                                    }, 2000);
                                });
                            }
                        } catch (error) {
                            console.error('Error in copy to clipboard:', error);
                        }
                    });
                } else {
                    console.warn('Copy button not found');
                }
            } catch (error) {
                console.error('Error setting up copy button:', error);
            }

            // Initial UI update
            try {
                updateUI();
            } catch (error) {
                console.error('Error in initial UI update:', error);
            }
        });
    </script>
</body>
</html>
